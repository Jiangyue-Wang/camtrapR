<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Apply time shifts to JPEG image metadata — timeShiftImages • camtrapR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Apply time shifts to JPEG image metadata — timeShiftImages" />
<meta property="og:description" content="Change the values of digital timestamps in image metadata using ExifTool. If date/time of images were set incorrectly, they can be corrected easily in batch mode for further analyses. Please, always make a backup of your data before using this function to avoid data loss or damage. This is because ExifTool will make a copy of your images and applies the time shifts to the copies. The file extentsion of the original images (.JPG) will be renamed to &quot;.JPG_original&quot;." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">camtrapR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/camtrapr1.html">1. Organising raw camera trap images in camtrapR</a>
    </li>
    <li>
      <a href="../articles/camtrapr2.html">2. Species and Individual Identification</a>
    </li>
    <li>
      <a href="../articles/camtrapr3.html">3. Data Extraction from Images and videos, creating occupancy &amp; secr input</a>
    </li>
    <li>
      <a href="../articles/camtrapr4.html">4. Data exploration and visualisation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jniedballa/camtrapR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Apply time shifts to JPEG image metadata</h1>
    
    <div class="hidden name"><code>timeShiftImages.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Change the values of digital timestamps in image metadata using ExifTool. If date/time of images were set incorrectly, they can be corrected easily in batch mode for further analyses. Please, always make a backup of your data before using this function to avoid data loss or damage. This is because ExifTool will make a copy of your images and applies the time shifts to the copies. The file extentsion of the original images (.JPG) will be renamed to ".JPG_original".</p>
    </div>

    <pre class="usage"><span class='fu'>timeShiftImages</span> <span class='op'>(</span><span class='va'>inDir</span>,
  <span class='va'>hasCameraFolders</span>,
  <span class='va'>timeShiftTable</span>,
  <span class='va'>stationCol</span>,
  <span class='va'>cameraCol</span>,
  <span class='va'>timeShiftColumn</span>,
  <span class='va'>timeShiftSignColumn</span>,
  undo <span class='op'>=</span> <span class='cn'>FALSE</span>,
  ignoreMinorErrors <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>inDir</th>
      <td><p>character. Name of directory containing station directories with images</p></td>
    </tr>
    <tr>
      <th>hasCameraFolders</th>
      <td><p>logical. Do the station directories in <code>inDir</code> have camera subdirectories (e.g. "inDir/StationA/Camera1")?</p></td>
    </tr>
    <tr>
      <th>timeShiftTable</th>
      <td><p>data.frame containing information about station-/camera-specific time shifts.</p></td>
    </tr>
    <tr>
      <th>stationCol</th>
      <td><p>character. name of the column specifying Station ID in <code>timeShiftTable</code></p></td>
    </tr>
    <tr>
      <th>cameraCol</th>
      <td><p>character. name of the column specifying Camera ID in <code>timeShiftTable</code> (optional)</p></td>
    </tr>
    <tr>
      <th>timeShiftColumn</th>
      <td><p>character. The name of the column containing time shift values in <code>timeShiftTable</code></p></td>
    </tr>
    <tr>
      <th>timeShiftSignColumn</th>
      <td><p>character. The name of the column with the direction of time shifts in <code>timeShiftTable</code>. Can only be "-" or "+".</p></td>
    </tr>
    <tr>
      <th>undo</th>
      <td><p>logical. Undo changes and restore the original images? Please be careful, this deletes any edited images if <code>TRUE</code></p></td>
    </tr>
    <tr>
      <th>ignoreMinorErrors</th>
      <td><p>logical. Ignore minor errors that would cause the function to fail (set TRUE for images with bad MakerNotes, observed in Panthera V4 cameras)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    

<p><code>timeShiftTable</code> is a data frame with columns for station ID, camera ID (optional), time shift value and direction of time shift (for an example  see <code><a href='timeShiftTable.html'>timeShiftTable</a></code>).
Images in <code>inDir</code> must be sorted into station directories. If <code>hasCameraFolders = TRUE</code>, the function expects camera subdirectories in the station directories and will only apply time shifts to the camera subdirectories specified by <code>CameraCol</code> in <code>timeShiftTable</code>. If <code>hasCameraFolders = FALSE</code>, shifts will be applied to the whole station directory (including potential subdirectories).</p>
<p>The values of <code>timeShiftColumn</code> must adhere to the following pattern: "YYYY:mm:dd HH:MM:SS" ("year:month:day hour:minute:second"). Examples: "1:0:0 0:0:0" is a shift of exactly 1 year and "0:0:0 12:10:01" 12 hours and 10 minutes and 1 second. Note that stating "00" may cause problems, so use "0" instead if an entry is zero.</p>
<p><code>timeShiftSignColumn</code> signifies the direction of the time shift. "+" moves image dates into the future (i.e. the image date lagged behind the actual date) and "-" moves image dates back (if the image dates were ahead of actual time).</p>
<p>ExifTool stores the original images as <code>.JPG_original</code> files in the original file location. By setting <code>undo = TRUE</code>, any JPG files in the directories specified by <code>timeShiftTable</code> will be deleted and the original JPEGs will be restored from the JPG_original files. Please make a backup before using <code>undo</code>.</p>
<p>Years can have 365 or 366 days, and months 28 to 31 days. Here is how the function handles these (from the exiftool help page):
"The ability to shift dates by Y years, M months, etc, conflicts with the design goal of maintaining a constant shift for all time values when applying a batch shift. This is because shifting by 1 month can be equivalent to anything from 28 to 31 days, and 1 year can be 365 or 366 days, depending on the starting date. The inconsistency is handled by shifting the first tag found with the actual specified shift, then calculating the equivalent time difference in seconds for this shift and applying this difference to subsequent tags in a batch conversion."</p>
<p><code>ignoreMinorErrors</code> is useful if image timestamps are not updated correctly (entries in column "n_images" of the output are "... files weren't updated due to errors"). This can be caused by bad MakerNotes and so far was only observed in Panthera V4 cameras. In that case, set <code>ignoreMinorErrors</code> to <code>TRUE</code>. This will add the "-m" option to the Exiftool call, thereby ignoring minor errors and warnings and applying the time shift nevertheless.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>data.frame</code> containing the information about the processed directories and the number of images.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><a href='https://exiftool.org/#shift'>https://exiftool.org/#shift</a></p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Juergen Niedballa</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>

<span class='co'># copy sample images to temporary directory (so we don't mess around in the package directory)</span>
<span class='va'>wd_images_ID</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"pictures/sample_images_species_dir"</span>, package <span class='op'>=</span> <span class='st'>"camtrapR"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.copy</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='va'>wd_images_ID</span>, to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, recursive <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>wd_images_ID_copy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"sample_images_species_dir"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>timeShiftTable</span><span class='op'>)</span>


<span class='va'>timeshift_run</span> <span class='op'>&lt;-</span> <span class='fu'>timeShiftImages</span><span class='op'>(</span>inDir                <span class='op'>=</span> <span class='va'>wd_images_ID_copy</span>,
                                 timeShiftTable       <span class='op'>=</span> <span class='va'>timeShiftTable</span>,
                                 stationCol           <span class='op'>=</span> <span class='st'>"Station"</span>,
                                 hasCameraFolders     <span class='op'>=</span> <span class='cn'>FALSE</span>,
                                 timeShiftColumn      <span class='op'>=</span> <span class='st'>"timeshift"</span>,
                                 timeShiftSignColumn  <span class='op'>=</span> <span class='st'>"sign"</span>,
                                 undo                 <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>


<span class='va'>timeshift_undo</span> <span class='op'>&lt;-</span> <span class='fu'>timeShiftImages</span><span class='op'>(</span>inDir               <span class='op'>=</span> <span class='va'>wd_images_ID_copy</span>,
                                  timeShiftTable      <span class='op'>=</span> <span class='va'>timeShiftTable</span>,
                                  stationCol          <span class='op'>=</span> <span class='st'>"Station"</span>,
                                  hasCameraFolders    <span class='op'>=</span> <span class='cn'>FALSE</span>,
                                  timeShiftColumn     <span class='op'>=</span> <span class='st'>"timeshift"</span>,
                                  timeShiftSignColumn <span class='op'>=</span> <span class='st'>"sign"</span>,
                                  undo                <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Juergen Niedballa, Alexandre Courtiol, Rahel Sollmann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


